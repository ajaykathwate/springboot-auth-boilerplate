#
# Server Properties
#
server:
  port: ${APP_SERVER_PORT}
  tomcat:
    accept-count: 100
    max-http-form-post-size: 2MB
    max-swallow-size: 2MB
  error:
    include-stacktrace: never
    include-message: never

#
# Spring Properties
#
spring:
  application:
    name: SpringBoot Auth Boilerplate
  main:
    allow-bean-definition-overriding: true
    allow-circular-references: false
  banner:
    charset: UTF-8
    location: classpath:banner.txt
  output:
    ansi:
      enabled: detect

  #
  # Database Properties
  #
  datasource:
    url: jdbc:postgresql://${DATASOURCE_HOST}:${DATASOURCE_PORT}/${DATASOURCE_NAME}?serverTimezone=UTC
    username: ${DATASOURCE_USERNAME}
    password: ${DATASOURCE_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: update
    open-in-view: false

  #
  # Redis Properties
  #
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}

  #
  # Email Properties
  #
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${GMAIL_MAIL}
    password: ${GMAIL_PASSWORD}
    subject:
      confirmation: "Springboot Auth Boilerplate - Email Confirmation"
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

  messages:
    basename: messages/messages

#
# Spring Doc Properties
#
springdoc:
  api-docs:
    path: /api/docs/schema
    enabled: true
  swagger-ui:
    path: /api/docs/swagger-ui
    enabled: true

#
# Management Properties
#
management:
  server:
    port: ${server.port}
  endpoint:
    shutdown:
      enabled: true
    health:
      enabled: true
      show-details: when-authorized
  endpoints:
    web:
      exposure:
        include: health, info, metrics, prometheus
      base-path: /actuator
  metrics:
    tags:
      application: ${spring.application.name}
  health:
    redis:
      enabled: true

#
# JWT Security Properties
#
jwt:
  header: Authorization
  secret: ${APP_JWT_SECRET}
  expiration: 900000 # 15 mins
  refresh-secret: ${APP_JWT_REFRESH_SECRET}
  refresh-expiration: 604800000 # 7 days

#
# OTP Properties
#
otp:
  length: 6
  expiration-minutes: 5

#
# Magic Link Properties
#
magic-link:
  expiration-minutes: 10

#
# Frontend Properties
#
frontend:
  base-url: ${FRONTEND_BASE_URL:http://localhost:3000}

#
# Logging Properties
#
logging:
  pattern:
    file: application-backend-%d{yyyy-MM-dd}.%i.log
  config: classpath:logback-spring.xml

#
# Google Auth Properties
#
google:
  client-id: ${GOOGLE_AUTH_CLIENT_ID}

#
# RabbitMQ Properties
#
spring.rabbitmq:
  host: ${RABBITMQ_HOST:localhost}
  port: ${RABBITMQ_PORT:5672}
  username: ${RABBITMQ_USERNAME:guest}
  password: ${RABBITMQ_PASSWORD:guest}
  virtual-host: ${RABBITMQ_VHOST:/}
  listener:
    simple:
      acknowledge-mode: manual
      prefetch: 1
      retry:
        enabled: false

#
# Notification Service Properties
#
notification:
  # Rate limiting per channel (requests per time window)
  rate-limit:
    email:
      max-requests: 50
      window-seconds: 3600
    sms:
      max-requests: 10
      window-seconds: 3600
    whatsapp:
      max-requests: 20
      window-seconds: 3600
    push:
      max-requests: 100
      window-seconds: 3600
    in_app:
      max-requests: 200
      window-seconds: 3600

  # Retry configuration
  retry:
    max-attempts: 10
    initial-backoff-ms: 1000
    multiplier: 2.0
    max-backoff-ms: 3600000

  # Queue configuration
  queue:
    exchange: notification.exchange
    dlx-exchange: notification.dlx
    dlq-queue: notification.dlq
    prefetch-count: 1

  # Template configuration
  template:
    base-path: classpath:/templates/notifications/
    cache-enabled: true

  # Twilio configuration (SMS & WhatsApp)
  twilio:
    enabled: ${TWILIO_ENABLED:false}
    account-sid: ${TWILIO_ACCOUNT_SID:}
    auth-token: ${TWILIO_AUTH_TOKEN:}
    from-number: ${TWILIO_FROM_NUMBER:}
    whatsapp-number: ${TWILIO_WHATSAPP_NUMBER:}

  # Firebase configuration (Push notifications)
  firebase:
    enabled: ${FIREBASE_ENABLED:false}
    service-account-path: src/main/resources/firebase-service-account.json
